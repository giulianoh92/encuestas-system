<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>{{ survey.denominacion }} - Encuesta</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
    .question { margin-bottom: 30px; border: 1px solid #ddd; padding: 15px; }
    .question-text { font-weight: bold; margin-bottom: 10px; }
    .options { margin-left: 20px; }
    .option { margin-bottom: 10px; }
    .submit-btn { padding: 10px 15px; background-color: #4CAF50; color: white; border: none; cursor: pointer; }
    .submit-btn:disabled { background-color: #cccccc; cursor: not-allowed; }
  </style>
</head>
<body>
  <h1>{{ survey.denominacion }}</h1>

  {% if message %}
    <div style="border:1px solid #f44336; color:#b71c1c; background:#ffebee; padding:10px; margin-bottom:20px;">
      {{ message }}
    </div>
  {% endif %}

  <form id="survey-form" action="/submit-survey" method="post">
    <input type="hidden" name="encuesta_id" value="{{ survey.id }}">
    
    {% for pregunta in preguntas %}
      <div class="question">
        <div class="question-text">{{ pregunta.texto }}</div>
        <div class="options">
          {% for opcion in opciones[pregunta.id] %}
            <div class="option">
              <input type="radio" id="opcion_{{ opcion.id }}" name="pregunta_{{ pregunta.id }}" value="{{ opcion.id }}" required>
              <label for="opcion_{{ opcion.id }}">{{ opcion.texto }}</label>
            </div>
          {% endfor %}
        </div>
      </div>
    {% endfor %}
    
    <button type="submit" class="submit-btn" id="submit-button" disabled>Enviar respuestas</button>
  </form>

  <script>
    // Activar botón solo cuando todas las preguntas están respondidas
    const form = document.getElementById('survey-form');
    const submitButton = document.getElementById('submit-button');
    const requiredInputs = form.querySelectorAll('input[required]');
    const totalQuestions = {{ preguntas|length }};
    
    form.addEventListener('change', function() {
      const selectedOptions = form.querySelectorAll('input[type="radio"]:checked').length;
      submitButton.disabled = selectedOptions < totalQuestions;
    });
  </script>
</body>
</html>